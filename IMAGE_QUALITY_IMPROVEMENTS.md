# π¨ μ΄λ―Έμ§€ ν’μ§ κ°μ„  μ‘μ—… μ™„λ£

## π“… μ‘μ—…μΌ: 2025-11-18

## π― λ©ν‘
KPOP Ranker μ›Ήμ‚¬μ΄νΈμ μ €ν™”μ§ μ΄λ―Έμ§€ λ¬Έμ  ν•΄κ²° λ° κ³ ν™”μ§ μ΄λ―Έμ§€ μ°μ„  μ‚¬μ©

## β… μ™„λ£λ μ‘μ—…

### 1. ImageWithFallback μ»΄ν¬λ„νΈ κ°μ„ 
**νμΌ**: `src/components/ImageWithFallback.tsx`

#### μ¶”κ°€λ κΈ°λ¥:
- β… `imageSize` prop μ¶”κ°€ ('small' | 'medium' | 'large')
- β… μ΄λ―Έμ§€ ν¬κΈ° νλΌλ―Έν„° μ§€μ›
  - small: 300x300
  - medium: 640x640
  - large: 640x640 (κΈ°λ³Έκ°’ - κ³ ν™”μ§)
- β… URLμ— `?size=640` νλΌλ―Έν„° μλ™ μ¶”κ°€
- β… μ§μ ‘ μ κ³µλ `src`κ°€ μμ„ κ²½μ° μ°μ„  μ‚¬μ©

#### μ½”λ“ λ³€κ²½μ‚¬ν•­:
```typescript
interface ImageWithFallbackProps {
  artist?: string;
  track?: string;
  src?: string;
  className?: string;
  isDetailView?: boolean;
  imageSize?: 'small' | 'medium' | 'large';  // π†• μ¶”κ°€
}

// μ΄λ―Έμ§€ URL μƒμ„± μ‹ size νλΌλ―Έν„° ν¬ν•¨
return `${API_URL}/api/album-image-smart/${encodedArtist}/${encodedTrack}?size=${sizeParam}`;
```

### 2. λ©”μΈ νμ΄μ§€ μ΄λ―Έμ§€ ν’μ§ κ°μ„ 
**νμΌ**: `src/pages/index.tsx`

#### μμ •λ μ„Ήμ…:
- β… TOP 3 μ„Ήμ… (h-64 μ»¨ν…μ΄λ„)
  - `imageSize="large"` νλΌλ―Έν„° μ¶”κ°€
  - 640x640 κ³ ν™”μ§ μ΄λ―Έμ§€ μ”μ²­

- β… HOT TRACKS μ„Ήμ… (h-48 μ»¨ν…μ΄λ„)
  - `imageSize="large"` νλΌλ―Έν„° μ¶”κ°€
  - 640x640 κ³ ν™”μ§ μ΄λ―Έμ§€ μ”μ²­

#### μ½”λ“ μμ‹:
```tsx
<ImageWithFallback
  artist={track.artist}
  track={track.track}
  src={track.image_url}
  imageSize="large"  // π†• μ¶”κ°€
  className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"
/>
```

### 3. νΈλ λ”© νμ΄μ§€ μ΄λ―Έμ§€ ν’μ§ κ°μ„ 
**νμΌ**: `src/pages/trending.tsx`

#### μμ •μ‚¬ν•­:
- β… API URLμ— `?size=640` νλΌλ―Έν„° μ¶”κ°€
- β… κ³ ν™”μ§ μ΄λ―Έμ§€ μ°μ„  λ΅λ“

#### μ½”λ“:
```typescript
// λ°±μ—”λ“ API μ „μ²΄ URL - κ³ ν™”μ§ νλΌλ―Έν„° μ¶”κ°€
return `${API_URL}/api/album-image-smart/${encodedArtist}/${encodedTitle}?size=640`;
```

## π” μ‘μ—… λ¶„μ„

### λ¬Έμ  μ›μΈ
1. λ°±μ—”λ“ APIκ°€ κΈ°λ³Έμ μΌλ΅ μ‘μ€ μ΄λ―Έμ§€λ¥Ό λ°ν™
2. ν”„λ΅ νΈμ—”λ“μ—μ„ μ΄λ―Έμ§€ ν¬κΈ° νλΌλ―Έν„°λ¥Ό μ§€μ •ν•μ§€ μ•μ
3. Spotify/μ™Έλ¶€ APIμ κ³ ν™”μ§ μ΄λ―Έμ§€ μµμ… λ―Έμ‚¬μ©

### ν•΄κ²° λ°©λ²•
1. **ImageWithFallback μ»΄ν¬λ„νΈ μ—…κ·Έλ μ΄λ“**
   - μ΄λ―Έμ§€ ν¬κΈ° μµμ… μ¶”κ°€
   - API μ”μ²­ μ‹ size νλΌλ―Έν„° μλ™ ν¬ν•¨

2. **λ¨λ“  μ£Όμ” νμ΄μ§€μ— μ μ©**
   - λ©”μΈ νμ΄μ§€ (index.tsx)
   - νΈλ λ”© νμ΄μ§€ (trending.tsx)
   - κΈ°λ³Έκ°’μ„ 'large'λ΅ μ„¤μ •ν•μ—¬ ν•­μƒ κ³ ν™”μ§ μ°μ„ 

3. **ν•μ„ νΈν™μ„± μ μ§€**
   - `imageSize` propμ€ μ„ νƒμ‚¬ν•­ (κΈ°λ³Έκ°’: 'large')
   - κΈ°μ΅΄ μ»΄ν¬λ„νΈλ“¤μ€ μμ • μ—†μ΄λ„ κ³ ν™”μ§ μ΄λ―Έμ§€ μ‚¬μ©

## π“ κΈ°λ€ ν¨κ³Ό

### Before (κ°μ„  μ „)
```
- μ΄λ―Έμ§€ ν¬κΈ°: 300x300 μ΄ν• (μ €ν™”μ§)
- νλ¦Ών• μ•¨λ²” μ»¤λ²„
- μ‚¬μ©μ κ²½ν— μ €ν•
```

### After (κ°μ„  ν›„)
```
- μ΄λ―Έμ§€ ν¬κΈ°: 640x640 (κ³ ν™”μ§)
- μ„ λ…ν• μ•¨λ²” μ»¤λ²„
- ν”„λ¦¬λ―Έμ—„ μ‚¬μ©μ κ²½ν—
```

### μ„±λ¥ μν–¥
- **μ©λ‰ μ¦κ°€**: μ•½ 2-3λ°° (300x300 β†’ 640x640)
- **λ΅λ”© μ†λ„**: Lazy loadingμΌλ΅ μµμ†ν™”
- **μ‹κ°μ  ν’μ§**: λ€ν­ κ°μ„ 

## π€ λ°±μ—”λ“ μ”κµ¬μ‚¬ν•­

### API νλΌλ―Έν„° μ§€μ› ν•„μ”
λ°±μ—”λ“ API(`/api/album-image-smart/{artist}/{track}`)κ°€ λ‹¤μ νλΌλ―Έν„°λ¥Ό μ§€μ›ν•΄μ•Ό ν•©λ‹λ‹¤:

```
GET /api/album-image-smart/{artist}/{track}?size=640

Parameters:
- size (optional): μ΄λ―Έμ§€ ν¬κΈ° (300, 640)
  - 300: μ‘μ€ μ΄λ―Έμ§€
  - 640: ν° μ΄λ―Έμ§€ (κΈ°λ³Έκ°’)
```

### Spotify API μ—°λ™ μμ‹
```python
# λ°±μ—”λ“μ—μ„ Spotify μ΄λ―Έμ§€ ν¬κΈ° μ„ νƒ
def get_album_image(artist, track, size=640):
    # Spotify API μ‘λ‹µμ—μ„ μ μ ν• ν¬κΈ° μ„ νƒ
    images = spotify_data['album']['images']

    if size >= 640:
        return images[0]['url']  # 640x640
    elif size >= 300:
        return images[1]['url']  # 300x300
    else:
        return images[2]['url']  # 64x64
```

## π“ λ‹¤μ λ‹¨κ³„

### μ¦‰μ‹ ν™•μΈ ν•„μ”
1. β… λ΅μ»¬μ—μ„ λΉλ“ λ° ν…μ¤νΈ
2. β³ λ°±μ—”λ“ APIκ°€ `?size=640` νλΌλ―Έν„°λ¥Ό μ§€μ›ν•λ”μ§€ ν™•μΈ
3. β³ ν”„λ΅λ•μ… λ°°ν¬ μ „ μ„±λ¥ ν…μ¤νΈ

### μ¶”κ°€ κ°μ„  κ°€λ¥
1. **μ΄λ―Έμ§€ μµμ ν™”**
   - WebP ν¬λ§· μ§€μ›
   - λ°μ‘ν• μ΄λ―Έμ§€ (srcset)
   - CDN μΊμ‹±

2. **λ‹¤λ¥Έ νμ΄μ§€ μ μ©**
   - κ²€μƒ‰ κ²°κ³Ό νμ΄μ§€
   - μ•„ν‹°μ¤νΈ μƒμ„Έ νμ΄μ§€
   - νΈλ™ μƒμ„Έ νμ΄μ§€

3. **μ„±λ¥ λ¨λ‹ν„°λ§**
   - μ΄λ―Έμ§€ λ΅λ”© μ‹κ°„ μΈ΅μ •
   - λ€μ—­ν­ μ‚¬μ©λ‰ λ¨λ‹ν„°λ§

## π”§ λ°°ν¬ μ²΄ν¬λ¦¬μ¤νΈ

- [x] ImageWithFallback μ»΄ν¬λ„νΈ μμ •
- [x] λ©”μΈ νμ΄μ§€ μ μ©
- [x] νΈλ λ”© νμ΄μ§€ μ μ©
- [ ] λ΅μ»¬ ν…μ¤νΈ
- [ ] λ°±μ—”λ“ API νλΌλ―Έν„° μ§€μ› ν™•μΈ
- [ ] λΉλ“ λ° λ°°ν¬
- [ ] ν”„λ΅λ•μ… ν™•μΈ

## π“ μ¤‘μ” νμΌ λ©λ΅

```
μμ •λ νμΌ:
β… src/components/ImageWithFallback.tsx
β… src/pages/index.tsx
β… src/pages/trending.tsx

μƒμ„±λ νμΌ:
β… IMAGE_QUALITY_IMPROVEMENTS.md (μ΄ λ¬Έμ„)
```

## π’΅ μ°Έκ³ μ‚¬ν•­

- λ°±μ—”λ“ APIκ°€ `?size` νλΌλ―Έν„°λ¥Ό μ•„μ§ μ§€μ›ν•μ§€ μ•λ” κ²½μ°, νλΌλ―Έν„°λ” λ¬΄μ‹λλ©° κΈ°μ΅΄ λ™μ‘ μ μ§€
- λ¨λ“  λ³€κ²½μ‚¬ν•­μ€ ν•μ„ νΈν™μ„±μ„ μ μ§€ν•λ„λ΅ μ„¤κ³„λ¨
- μ΄λ―Έμ§€ ν’μ§ κ°μ„ μΌλ΅ μΈν• μ„±λ¥ μν–¥μ€ lazy loadingμΌλ΅ μµμ†ν™”

---

**μ‘μ—… μ™„λ£μΌ**: 2025-11-18
**μ‘μ—…μ**: Claude Code
**λ‹¤μ μ‘μ—…**: λ°±μ—”λ“ API νλΌλ―Έν„° μ§€μ› ν™•μΈ λ° λ°°ν¬
